<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instituto Vita</title>
    <link rel="icon" href="/image/logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=EB+Garamond&family=Uncial+Antiqua&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/reservas/style_nova_reserva.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <!-- ======================================================================================================================-->
    <!--===================================================== MENU ============================================================-->
    <!--====================================================================================================================== -->
    <nav>
        <a href="/" class="img">
            <img src="/image/logo.png" alt="Logo da Empresa" class="img-logo">
        </a>
        <a href="/nav/sobre-nos">Sobre nós</a>
        <a href="/nav/sobre-cancer">Sobre o câncer</a>
        <a href="/nav/acomodacoes">Acomodações</a>
        <a href="/nav/apoio-paciente">Apoio ao paciente</a>
        <a href="/nav/localizacao">Localizações</a>
        <a href="/perguntas/perguntas-frequentes">Perguntas frequentes</a>
        <% if (!user) { %>
            <!-- Usuário não logado -->
            <a href="/usuarios/login" class="btn-entrar">Entrar</a>
            <a href="/usuarios/cadastro" class="btn-cadastrar">Cadastrar</a>
            <% } else { %>
                <!-- Usuário logado -->
                <% if (user.tipo==='paciente' ) { %>
                    <a href="/paciente/minhas-reservas" class="btn-nav">Minhas Reservas</a>
                    <% } else if (user.tipo==='acompanhante' ) { %>
                        <a href="/acompanhante/apoio-ao-paciente" class="btn-nav">Apoio ao Paciente</a>
                        <% } else if (user.tipo==='voluntario' ) { %>
                            <a href="/voluntario/area-do-voluntario" class="btn-nav">Área do Voluntários</a>
                            <% } else if (user.tipo==='doador' ) { %>
                                <a href="/doador/minhas-doacoes" class="btn-nav">Minhas Doações</a>
                                <% } else if (user.tipo==='admin' ) { %>
                                    <a href="/admin/painel" class="btn-nav">Configurações</a>
                                    <% } else { %>
                                        <!-- Caso algum outro tipo apareça -->
                                        <a href="/usuarios/login" class="btn-entrar">Entrar</a>
                                        <a href="/usuarios/cadastro" class="btn-cadastrar">Cadastrar</a>
                                        <% } %>
                                            <!-- Botão de logout -->
                                            <a href="/usuarios/logout" class="btn-logout">Sair</a>
                                            <% } %>
    </nav>

    <div class="container my-5">
        <h2 class="text-center">Escolha seu quarto e preencha os dados da reserva</h2>
        <% if (flashMessage && flashMessage.length> 0) { %>
            <div class="alert alert-danger" role="alert">
                <%= flashMessage %>
            </div>
            <% } %>
        
        <form action="/reservas/nova" method="POST" class="card p-4 shadow-sm bg-white">
            <div class="quartos-grid">
                <% if (quartos && quartos.length> 0) { %>
                    <% quartos.forEach(quarto=> { %>
                        <div class="col">
                            <div class="quarto-card">
                                <% if (quarto.fotos && quarto.fotos.length> 0) { %>
                                    <img class="main-img" id="main-img-<%= quarto.quarto_id %>"
                                        src="<%= quarto.fotos[0].foto_caminho %>" alt="Imagem principal do quarto">
                                    <div class="thumbnails">
                                        <% quarto.fotos.forEach(foto=> { %>
                                            <img src="<%= foto.foto_caminho %>"
                                                data-target="main-img-<%= quarto.quarto_id %>" alt="miniatura">
                                            <% }) %>
                                    </div>
                                    <% } else { %>
                                        <img class="main-img" src="/img/quartos/sem-imagem.jpg"
                                            alt="Sem imagem disponível">
                                        <% } %>
                                        <div class="card-body">
                                            <h5>
                                                <%= quarto.tipo_quarto_nome %>
                                            </h5>
                                            <p>
                                                <%= quarto.tipo_quarto_descricao %>
                                            </p>
                                            <p><strong>Número:</strong>
                                                <%= quarto.quarto_numero %>
                                            </p>
                                            <p><strong>Andar:</strong>
                                                <%= quarto.quarto_andar %>
                                            </p>
                                        </div>
                                        <div class="card-footer bg-transparent">
                                            <input type="radio" name="quarto_id" value="<%= quarto.quarto_id %>"
                                                id="quarto_<%= quarto.quarto_id %>" required>
                                            <label for="quarto_<%= quarto.quarto_id %>">Selecionar este quarto</label>
                                        </div>
                            </div>
                        </div>
                        <% }) %>
                            <% } else { %>
                                <p class="text-center w-100">Nenhum quarto disponível no momento. Tente novamente mais
                                    tarde.</p>
                                <% } %>
            </div>
            <h3 class="mt-5 mb-3">Detalhes da Reserva</h3>
            <div class="mb-3">
                <label class="form-label">Data de Check-in (Previsão):</label>
                <input type="datetime-local" class="form-control" name="reserva_data_checkin_previsto" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Data de Check-out (Previsão):</label>
                <input type="datetime-local" class="form-control" name="reserva_data_checkout_previsto" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Motivo da estadia:</label>
                <textarea class="form-control" name="reserva_motivo" placeholder="Descreva o motivo da estadia"
                    required></textarea>
            </div>
            <div class="text-center mt-4">
                <button type="submit" class="btn btn-success btn-lg px-4">Confirmar Reserva</button>
            </div>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Script para trocar a imagem principal ao clicar em miniaturas
        document.addEventListener('DOMContentLoaded', () => { // Usar DOMContentLoaded é uma boa prática
            document.querySelectorAll('.thumbnails img').forEach(img => {
                img.addEventListener('click', () => {
                    const targetId = img.getAttribute('data-target');
                    const mainImg = document.getElementById(targetId);
                    
                    if (mainImg) {
                         // Troca a imagem principal
                        mainImg.src = img.src; 
                        
                        // Opcional: Adicionar ou remover classes de seleção visual nas miniaturas
                        const thumbnailsContainer = img.closest('.thumbnails');
                        thumbnailsContainer.querySelectorAll('img').forEach(i => i.classList.remove('selected'));
                        img.classList.add('selected');
                    }
                });
            });
        });
    </script>

    <!-- ======================================================================================================================-->
    <!--==================================================== FOOTER ===========================================================-->
    <!--====================================================================================================================== -->
    <footer>
        <div class="footer-container">
            <div class="footer-about">
                <h3>Sobre a Empresa</h3>
                <p>Somos uma organização dedicada a oferecer hospedagem com amor, cuidado e dignidade para pacientes e
                    familiares.</p>
            </div>
            <div class="footer-contact">
                <h3>Contato</h3>
                <p>Email: contato@empresa.com.br</p>
                <p>Telefone: (11) 1234-5678</p>
                <p>Endereço: Rua Exemplo, 123 - São Paulo, SP</p>
            </div>
            <div class="footer-links">
                <h3>Links Úteis</h3>
                <a href="#">Política de Privacidade</a><br>
                <a href="#">Termos de Uso</a><br>
                <a href="#">Ajuda</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2024 Empresa. Todos os direitos reservados.</p>
        </div>
    </footer>

</body>

</html>