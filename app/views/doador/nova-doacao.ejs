<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova Doa√ß√£o - Instituto Vita</title>
    <link rel="icon" href="/image/logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=EB+Garamond&family=Uncial+Antiqua&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/doador/style_nova_doacao.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!--===================================================== MENU ============================================================-->
    <nav>
        <a href="/" class="img">
            <img src="/image/logo.png" alt="Logo da Empresa" class="img-logo">
        </a>
        <a href="/nav/sobre-nos">Sobre n√≥s</a>
        <a href="/nav/sobre-cancer">Sobre o c√¢ncer</a>
        <a href="/nav/acomodacoes">Acomoda√ß√µes</a>
        <a href="/nav/apoio-paciente">Apoio ao paciente</a>
        <a href="/nav/localizacao">Localiza√ß√µes</a>
        <a href="/perguntas/perguntas-frequentes">Perguntas frequentes</a>
        <% if (!user) { %>
            <!-- Usu√°rio n√£o logado -->
            <a href="/usuarios/login" class="btn-entrar">Entrar</a>
            <a href="/usuarios/cadastro" class="btn-cadastrar">Cadastrar</a>
            <% } else { %>
                <!-- Usu√°rio logado -->
                <% if (user.tipo==='paciente' ) { %>
                    <a href="/paciente/minhas-reservas" class="btn-nav">Minhas Reservas</a>
                    <% } else if (user.tipo==='acompanhante' ) { %>
                        <a href="/acompanhante/apoio-ao-paciente" class="btn-nav">Apoio ao Paciente</a>
                            <% } else if (user.tipo==='doador' ) { %>
                                <a href="/doador/minhas-doacoes" class="btn-nav">Minhas Doa√ß√µes</a>
                                <% } else if (user.tipo==='admin' ) { %>
                                    <a href="/admin/painel" class="btn-nav">Configura√ß√µes</a>
                                    <% } else { %>
                                        <!-- Caso algum outro tipo apare√ßa -->
                                        <a href="/usuarios/login" class="btn-entrar">Entrar</a>
                                        <a href="/usuarios/cadastro" class="btn-cadastrar">Cadastrar</a>
                                        <% } %>
                                            <!-- Bot√£o de logout -->
                                            <a href="/usuarios/logout" class="btn-logout">Sair</a>
                                            <% } %>
    </nav>

    <section id="nova-doacao" class="conteudo">

        <% if (errors && errors.length> 0) { %>
            <div class="alert alert-danger">
                <% errors.forEach(e=> { %><p>
                        <%= e %>
                    </p>
                    <% }) %>
            </div>
            <% } %>

                <% if (success) { %>
                    <div class="alert alert-success">
                        <%= success %>
                    </div>
                    <% } %>

                        <div class="card">
                            <h3 class="card-title">Fa√ßa uma Doa√ß√£o</h3>
                            <p class="card-subtitle">Escolha a forma como deseja contribuir para o cuidado e acolhimento de pacientes oncol√≥gicos e suas fam√≠lias.</p>

                            <div class="doacao-opcoes">
                                <div class="opcao-item">
                                    <span class="opcao-icon">üíµ</span>
                                    <h4>Doa√ß√£o Financeira</h4>
                                    <p>Contribui√ß√£o em dinheiro via PIX, cart√£o de cr√©dito, boleto ou dep√≥sito banc√°rio. Sua doa√ß√£o ser√° direcionada para onde √© mais necess√°ria.</p>
                                    <button class="btn-primary btn-escolher" data-tipo="financeira">
                                        <i class="fas fa-heart"></i> Doar Agora
                                    </button>
                                </div>

                                <div class="opcao-item">
                                    <span class="opcao-icon">üéÅ</span>
                                    <h4>Doa√ß√£o de Produtos</h4>
                                    <p>Roupas, cobertores, livros, materiais de higiene e outros itens essenciais para o conforto dos pacientes durante o tratamento.</p>
                                    <button class="btn-primary btn-escolher" data-tipo="produto">
                                        <i class="fas fa-box-open"></i> Doar Produto
                                    </button>
                                </div>

                                <div class="opcao-item">
                                    <span class="opcao-icon">üçé</span>
                                    <h4>Doa√ß√£o de Alimentos</h4>
                                    <p>Cestas b√°sicas, alimentos perec√≠veis e n√£o perec√≠veis para garantir nutri√ß√£o adequada aos pacientes e acompanhantes.</p>
                                    <button class="btn-primary btn-escolher" data-tipo="alimento">
                                        <i class="fas fa-utensils"></i> Doar Alimento
                                    </button>
                                </div>
                            </div>

                            <!-- FORMUL√ÅRIO GERAL -->
                            <form id="form-doacao" action="/doacoes/nova" method="POST" style="display:none">
                                <div class="form-header">
                                    <i class="fas fa-hand-holding-heart" style="color: var(--cor-principal); font-size: 1.5rem;"></i>
                                    <h3>Complete os Dados da Sua Doa√ß√£o</h3>
                                </div>

                                <input type="hidden" name="doacao_tipo" id="doacao_tipo">

                                <!-- DESTINO DA DOA√á√ÉO -->
                                <div class="campo">
                                    <label for="destino-doacao"><i class="fas fa-bullseye"></i> Destino da Doa√ß√£o:</label>
                                    <select name="doacao_destino" id="destino-doacao" required>
                                        <option value="" disabled selected>Selecione para onde sua doa√ß√£o ser√° direcionada</option>
                                        <option value="Apoiar Pacientes">Apoiar Pacientes (Hospedagem e Alimenta√ß√£o)</option>
                                        <option value="Atividades de Bem-Estar">Atividades de Bem-Estar (Terapias e Oficinas)</option>
                                        <option value="Manuten√ß√£o do Hotel">Manuten√ß√£o do Hotel (Infraestrutura)</option>
                                        <option value="Campanhas Espec√≠ficas">Campanhas Espec√≠ficas (Emerg√™ncias)</option>
                                        <option value="Medicamentos e Insumos">Medicamentos e Insumos</option>
                                        <option value="Eventos Solid√°rios">Eventos Solid√°rios</option>
                                        <option value="Infraestrutura e Obras">Infraestrutura e Obras</option>
                                    </select>
                                </div>

                                <!-- RECORR√äNCIA -->
                                <div class="campo">
                                    <label for="recorrencia-doacao"><i class="fas fa-redo"></i> Recorr√™ncia da Doa√ß√£o:</label>
                                    <select name="doacao_recorrencia" id="recorrencia-doacao">
                                        <option value="√önica">Doa√ß√£o √önica</option>
                                        <option value="Mensal">Doa√ß√£o Mensal</option>
                                        <option value="Trimestral">Doa√ß√£o Trimestral</option>
                                        <option value="Anual">Doa√ß√£o Anual</option>
                                    </select>
                                </div>

                                <!-- FORM FINANCEIRO -->
                                <div id="form-financeiro" class="form-bloco" style="display:none">
                                    <h3>Detalhes da Doa√ß√£o Financeira</h3>

                                    <div class="campo">
                                        <label for="valor-input"><i class="fas fa-money-bill-wave"></i> Valor da Doa√ß√£o (R$):</label>
                                        <input type="number" step="0.01" name="doacao_valor" id="valor-input" min="1" placeholder="Ex: 50,00">
                                    </div>

                                    <div class="campo">
                                        <label for="metodo-pagamento"><i class="fas fa-credit-card"></i> M√©todo de Pagamento:</label>
                                        <select name="doacao_metodo_pagamento" id="metodo-pagamento">
                                            <option value="Pix">PIX (Mais r√°pido e sem taxas)</option>
                                            <option value="Cart√£o de Cr√©dito">Cart√£o de Cr√©dito</option>
                                            <option value="Boleto">Boleto Banc√°rio</option>
                                            <option value="Dep√≥sito Banc√°rio">Dep√≥sito Banc√°rio</option>
                                            <option value="Outro">Outro</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- FORM PRODUTOS -->
                                <div id="form-produto" class="form-bloco" style="display:none">
                                    <h3>Detalhes da Doa√ß√£o de Produto</h3>

                                    <div class="campo">
                                        <label for="produto-categoria"><i class="fas fa-tags"></i> Categoria do Produto:</label>
                                        <input type="text" name="produto_categoria_item" id="produto-categoria" placeholder="Ex: Roupas, Livros, Material de Higiene">
                                    </div>

                                    <div class="campo">
                                        <label for="produto-quantidade"><i class="fas fa-calculator"></i> Quantidade:</label>
                                        <input type="number" name="produto_quantidade" id="produto-quantidade" min="1" placeholder="Ex: 5">
                                    </div>

                                    <div class="campo">
                                        <label for="condicao-item"><i class="fas fa-check-circle"></i> Condi√ß√£o do Item:</label>
                                        <select name="doacao_condicao" id="condicao-item">
                                            <option value="Novo">Novo (Lacrado/Com etiqueta)</option>
                                            <option value="Seminovo">Seminovo (Pouco uso, em √≥timo estado)</option>
                                            <option value="Usado em bom estado">Usado em bom estado</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- FORM ALIMENTOS -->
                                <div id="form-alimento" class="form-bloco" style="display:none">
                                    <h3>Detalhes da Doa√ß√£o de Alimentos</h3>

                                    <div class="campo">
                                        <label for="alimento-categoria"><i class="fas fa-apple-alt"></i> Tipo de Alimento:</label>
                                        <input type="text" name="alimento_categoria_item" id="alimento-categoria" placeholder="Ex: Arroz, Feij√£o, Leite, Frutas">
                                    </div>

                                    <div class="campo">
                                        <label for="alimento-quantidade"><i class="fas fa-weight"></i> Quantidade:</label>
                                        <input type="number" name="alimento_quantidade" id="alimento-quantidade" min="1" placeholder="Ex: 10">
                                    </div>

                                    <div class="campo">
                                        <label for="alimento-unidade"><i class="fas fa-balance-scale"></i> Unidade de Medida:</label>
                                        <input type="text" name="alimento_unidade" id="alimento-unidade" placeholder="Ex: kg, pacotes, litros, caixas">
                                    </div>
                                </div>

                                <div id="impacto-texto">
                                    <strong><i class="fas fa-heartbeat"></i> Impacto da Sua Doa√ß√£o:</strong> Escolha o tipo de doa√ß√£o e preencha os dados para calcular o impacto.
                                </div>

                                <button class="btn-primary btn-confirmar" type="submit">
                                    <i class="fas fa-paper-plane"></i> Confirmar e Enviar Doa√ß√£o
                                </button>
                            </form>
                        </div>
    </section>

    <script>
        document.querySelectorAll(".btn-escolher").forEach(btn => {
            btn.addEventListener("click", () => {
                const tipo = btn.dataset.tipo;
                const form = document.getElementById("form-doacao");
                const tipoInput = document.getElementById("doacao_tipo");
                const cardTitle = document.querySelector(".card-title");
                const cardSubtitle = document.querySelector(".card-subtitle");

                // Anima√ß√£o suave para mostrar o formul√°rio
                form.style.display = "block";
                setTimeout(() => {
                    form.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);

                // Atualiza o t√≠tulo e subt√≠tulo
                if (tipo === "financeira") {
                    cardTitle.textContent = "Doa√ß√£o Financeira";
                    cardSubtitle.textContent = "Sua contribui√ß√£o financeira ser√° transformada em cuidados diretos para pacientes e fam√≠lias.";
                } else if (tipo === "produto") {
                    cardTitle.textContent = "Doa√ß√£o de Produtos";
                    cardSubtitle.textContent = "Produtos de qualidade melhoram o conforto e bem-estar durante o tratamento.";
                } else if (tipo === "alimento") {
                    cardTitle.textContent = "Doa√ß√£o de Alimentos";
                    cardSubtitle.textContent = "Alimentos nutritivos s√£o essenciais para a recupera√ß√£o e for√ßa durante o tratamento.";
                }

                // Define o tipo de doa√ß√£o no campo oculto
                let formatoFinal =
                    tipo === "financeira" ? "Financeira" :
                        tipo === "produto" ? "Produto" :
                            tipo === "alimento" ? "Alimento" :
                                "";

                tipoInput.value = formatoFinal;

                // Esconde todos os formul√°rios espec√≠ficos primeiro
                document.querySelectorAll(".form-bloco").forEach(b => b.style.display = "none");

                // Mostra o formul√°rio espec√≠fico
                if (tipo === "financeira") {
                    document.getElementById("form-financeiro").style.display = "block";
                } else if (tipo === "produto") {
                    document.getElementById("form-produto").style.display = "block";
                } else if (tipo === "alimento") {
                    document.getElementById("form-alimento").style.display = "block";
                }

                // Atualiza o texto de impacto inicial
                updateImpactText(tipo);
            });
        });

        // Impacto da doa√ß√£o financeira
        document.getElementById("valor-input")?.addEventListener("input", e => {
            const v = parseFloat(e.target.value);
            const impacto = document.getElementById("impacto-texto");

            if (!v || v <= 0) {
                impacto.innerHTML = `<strong><i class="fas fa-heartbeat"></i> Impacto da Sua Doa√ß√£o:</strong> Informe um valor para calcular o impacto da sua contribui√ß√£o.`;
                return;
            }

            const pacientes = Math.round(v / 10);
            const dias = Math.max(1, Math.round(v / 30));
            const refeicoes = Math.round(v / 5);

            impacto.innerHTML = `
                <strong><i class="fas fa-heartbeat"></i> Impacto da Sua Doa√ß√£o:</strong> Com R$${v.toFixed(2)}, voc√™ pode fornecer aproximadamente 
                <b>${refeicoes} refei√ß√µes nutritivas</b> e apoiar o cuidado de <b>${pacientes} pacientes</b> por <b>${dias} dias</b>. 
                Sua doa√ß√£o faz uma diferen√ßa real!
            `;
        });

        // Fun√ß√£o para atualizar o texto de impacto baseado no tipo
        function updateImpactText(tipo) {
            const impacto = document.getElementById("impacto-texto");
            
            if (tipo === "financeira") {
                impacto.innerHTML = `<strong><i class="fas fa-heartbeat"></i> Impacto da Sua Doa√ß√£o:</strong> Informe o valor para calcular o impacto da sua contribui√ß√£o financeira.`;
            } else if (tipo === "produto") {
                impacto.innerHTML = `<strong><i class="fas fa-heartbeat"></i> Impacto da Sua Doa√ß√£o:</strong> Produtos doados trazem conforto, dignidade e bem-estar aos pacientes durante o tratamento.`;
            } else if (tipo === "alimento") {
                impacto.innerHTML = `<strong><i class="fas fa-heartbeat"></i> Impacto da Sua Doa√ß√£o:</strong> Alimentos nutritivos s√£o fundamentais para a recupera√ß√£o e for√ßa dos pacientes durante o tratamento.`;
            }
        }

        // Adiciona valida√ß√£o b√°sica ao formul√°rio
        document.getElementById("form-doacao")?.addEventListener("submit", function(e) {
            const tipo = document.getElementById("doacao_tipo").value;
            let isValid = true;
            
            if (tipo === "Financeira") {
                const valor = document.getElementById("valor-input").value;
                if (!valor || parseFloat(valor) <= 0) {
                    alert("Por favor, informe um valor v√°lido para a doa√ß√£o.");
                    isValid = false;
                }
            }
            
            if (!isValid) {
                e.preventDefault();
            } else {
                // Anima√ß√£o de envio
                const btn = document.querySelector(".btn-confirmar");
                btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> Processando Doa√ß√£o...`;
                btn.disabled = true;
            }
        });
    </script>

    <!--==================================================== FOOTER ===========================================================-->
    <footer>
        <div class="footer-container">
            <div class="footer-about">
                <h3>Sobre a Empresa</h3>
                <p>Somos uma organiza√ß√£o dedicada a oferecer hospedagem com amor, cuidado e dignidade para pacientes e
                    familiares.</p>
            </div>
            <div class="footer-contact">
                <h3>Contato</h3>
                <p>Email: contato@empresa.com.br</p>
                <p>Telefone: (11) 1234-5678</p>
                <p>Endere√ßo: Rua Exemplo, 123 - S√£o Paulo, SP</p>
            </div>
            <div class="footer-links">
                <h3>Links √öteis</h3>
                <a href="#">Pol√≠tica de Privacidade</a><br>
                <a href="#">Termos de Uso</a><br>
                <a href="#">Ajuda</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>¬© 2024 Empresa. Todos os direitos reservados.</p>
        </div>
    </footer>

</body>

</html>